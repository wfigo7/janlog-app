# バージョン管理ルール化 - 実装タスク

- [x] 1. バージョン管理ドキュメントの作成
  - プロジェクトルートに`VERSIONING.md`を作成
  - セマンティックバージョニングのルールと例を記載
  - バージョンインクリメントの判断フローチャートを記載
  - サブシステムバージョン管理戦略を記載
  - バージョン互換性マトリクスのフォーマットを記載
  - リリースプロセスとGitタグ付け戦略を記載
  - _要件: 要件5_

- [x] 2. バックエンドのバージョン管理設定
  - [x] 2.1 pyproject.tomlにバージョン情報を追加
    - `[project]`セクションに`version = "0.1.0"`を追加
    - `name`と`description`も適切に設定
    - _要件: 要件1, 要件2_
  
  - [x] 2.2 バージョン読み込みモジュールの作成
    - `backend/app/version.py`を作成
    - `tomllib`を使用して`pyproject.toml`からバージョンを読み込む関数を実装
    - エラーハンドリングを実装（ファイルが存在しない場合は"unknown"を返す）
    - _要件: 要件2_
  
  - [x] 2.3 バージョンエンドポイントの実装
    - 既存の`/health`エンドポイントにバージョン情報が含まれることを確認
    - `backend/app/main.py`の`health_check`関数で`VERSION`を使用していることを確認
    - `/health`エンドポイントのコメントを更新し、バージョン情報も提供することを明記
    - 注: 専用の`/version`エンドポイントは作成せず、`/health`を活用
    - _要件: 要件3_

- [x] 3. フロントエンドのバージョン管理設定
  - [x] 3.1 package.jsonとapp.jsonのバージョン統一
    - `frontend/package.json`のバージョンを`0.1.0`に設定
    - `frontend/app.json`のバージョンを`0.1.0`に設定
    - `app.json`に`ios.buildNumber`を追加（値: "1"）
    - _要件: 要件1, 要件2, 要件6_
  
  - [x] 3.2 バージョン情報取得フックの作成
    - `frontend/src/hooks/useVersion.ts`を作成
    - `expo-constants`を使用してアプリバージョンとビルド番号を取得
    - `/health`エンドポイントからサーバーバージョンを取得
    - エラーハンドリングを実装（サーバー到達不可時は`null`を返す）
    - _要件: 要件4_
  
  - [x] 3.3 バージョン情報表示コンポーネントの作成
    - `frontend/components/VersionInfo.tsx`を作成
    - アプリバージョン、ビルド番号、サーバーバージョンを表示
    - サーバーバージョンが取得できない場合は「不明」と表示
    - _要件: 要件4_
  
  - [x] 3.4 設定画面へのバージョン情報追加
    - 既存の設定画面（`frontend/app/(tabs)/settings.tsx`または`profile.tsx`）を確認
    - `VersionInfo`コンポーネントを設定画面に追加
    - 適切なレイアウトとスタイリングを適用
    - _要件: 要件4_

- [x] 4. インフラストラクチャのバージョン管理設定
  - `infra/package.json`のバージョンを`0.1.0`に設定
  - `name`と`description`も適切に設定
  - _要件: 要件2_

- [x] 5. バージョン互換性マトリクスの初期化
  - `VERSIONING.md`にバージョン互換性マトリクスの初期エントリを追加
  - 現在のバージョン（0.1.0）の互換性情報を記載
  - 互換性ルールを明記
  - _要件: 要件2_

- [x] 6. リリースプロセスの文書化
  - `VERSIONING.md`にリリースフローを記載
  - バージョン更新手順を詳細に記載
  - Gitタグ作成方法を記載
  - CI/CDとの連携方法を記載
  - _要件: 要件5_

- [ ]* 7. テストの実装
  - [ ]* 7.1 バックエンドのバージョンエンドポイントテスト
    - `tests/test_version.py`を作成
    - バージョン取得関数のユニットテスト
    - `/health`エンドポイントにバージョン情報が含まれることのテスト
    - レスポンス形式の検証
    - _要件: 要件3_
  
  - [ ]* 7.2 フロントエンドのバージョンフックテスト
    - `frontend/__tests__/hooks/useVersion.test.ts`を作成
    - `useVersion`フックのテスト
    - サーバーバージョン取得成功時のテスト
    - サーバーバージョン取得失敗時のテスト
    - _要件: 要件4_


- [x] 8. 既存のバージョン参照箇所の更新
  - `backend/app/main.py`の`version="1.0.0"`を`version=VERSION`に変更
  - `backend/app/main.py`の`HealthResponse`の`version`フィールドを`VERSION`に変更
  - ハードコードされたバージョン番号を全て削除
  - _要件: 要件2_

- [x] 9. ドキュメントの更新
  - `README.md`にバージョン管理セクションを追加
  - `VERSIONING.md`へのリンクを追加
  - リリースプロセスの概要を記載
  - _要件: 要件5_
